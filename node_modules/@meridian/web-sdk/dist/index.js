!function(e,t){for(var o in t)e[o]=t[o]}(exports,function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=26)}([function(e,t){e.exports=require("preact")},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("babel-runtime/regenerator")},function(e,t){e.exports=require("babel-runtime/helpers/extends")},function(e,t){e.exports=require("babel-runtime/helpers/createClass")},function(e,t){e.exports=require("babel-runtime/helpers/classCallCheck")},function(e,t){e.exports=require("babel-runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("babel-runtime/helpers/possibleConstructorReturn")},function(e,t){e.exports=require("babel-runtime/helpers/inherits")},function(e,t){e.exports=require("babel-runtime/core-js/object/get-prototype-of")},function(e,t){e.exports=require("babel-runtime/core-js/object/keys")},function(e,t){e.exports=require("babel-runtime/core-js/get-iterator")},function(e,t){e.exports=require("d3-zoom")},function(e,t){e.exports=require("lodash.groupby")},function(e,t){e.exports=require("babel-runtime/helpers/toConsumableArray")},function(e,t){e.exports=require("axios")},function(e,t){e.exports=require("d3-selection")},function(e,t){e.exports=require("socket.io-client")},function(e,t){e.exports=require("lodash.throttle")},function(e,t){e.exports=require("babel-runtime/helpers/taggedTemplateLiteral")},function(e,t){e.exports=require("babel-runtime/helpers/slicedToArray")},function(e,t){e.exports=require("babel-runtime/core-js/promise")},function(e,t){e.exports=require("create-emotion")},function(e,t){e.exports=require("babel-runtime/helpers/defineProperty")},function(e,t,o){"use strict";o.r(t);var n=o(3),r=o.n(n),a=o(2),i=o.n(a),l=o(6),s=o.n(l),c=o(0),u=o(15),d=o.n(u),p=o(11),h=o.n(p),f=o(10),g=o.n(f),m=o(23),v=o.n(m),b=o(14),k=o.n(b),y=o(9),O=o.n(y),x=o(5),C=o.n(x),w=o(4),I=o.n(w),S=o(7),T=o.n(S),j=o(8),R=o.n(j),D=o(1),M=o.n(D),z=o(12),F=o(16),q=o(22),B=o.n(q),L={fontSizeSmallest:"12px",fontSizeSmaller:"14px",fontSize:"16px",fontSizeBigger:"18px",textColor:"#1b1b1b",black:"#000",white:"#fff",almostWhite:"#fafafa",textColorBluish:"hsl(208, 17%, 42%)",brandOrange:"#ff8300",brandBlue:"hsl(203, 100%, 23%)",brandBrightBlue:"hsl(207, 65%, 46%)",buttonActiveColor:"hsl(201, 55%, 94%)",buttonHoverColor:"hsl(200, 60%, 97%)",buttonSeparatorColor:"#f0f0f0",borderColor:"#ebeef2",borderColorDarker:"#dfe1e5",borderRadius:6},_={flexRow:{display:"flex",flexDirection:"row"},flexColumn:{display:"flex",flexDirection:"column"},overflowEllipses:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},textStrokeWhite:{WebkitFontSmoothing:"antialiased",textShadow:"\n      rgba(255, 255, 255, 0.75) 0 0 1px,\n      rgba(255, 255, 255, 0.75) 0 0 1px,\n      rgba(255, 255, 255, 0.75) 0 0 1px,\n      rgba(255, 255, 255, 0.75) 0 0 1px\n    "},buttonReset:{padding:0,margin:0,font:"inherit",border:0,borderRadius:0,background:"transparent",color:"inherit","&::-moz-focus-inner":{border:0}},buttonHoverActive:{"&:hover":{background:L.buttonHoverColor},"&:active":{background:L.buttonActiveColor}},borderBox:{boxSizing:"border-box"},focusRing:{"&:focus":{outline:0,boxShadow:"inset 0 0 0 1px "+L.brandBrightBlue}},focusRingMenuItem:{"&:focus":{outline:0,boxShadow:"\n        inset 0 0 0 1px white,\n        inset 0 0 0 2px "+L.brandBrightBlue+"\n      "}},focusOutline:{"&:focus":{outline:0,boxShadow:"0 0 0 2px currentcolor"}},focusDarken:{"&:focus":{outline:0,boxShadow:"inset 0 0 0 9999px rgba(0, 0, 0, 0.1)"}},focusNone:{"&:focus":{outline:"none"}},shadow:{boxShadow:"0 0 3px rgba(0, 0, 0, 0.25)"},rounded:{borderRadius:L.borderRadius},maxRounded:{borderRadius:99999},paddingMedium:{padding:"20px"},pointer:{cursor:"pointer","&:disabled":{cursor:"default"}}},N="undefined"!=typeof global?global:{},Z=B()(N,{key:"meridian--private-"}),U=Z.cx,P=Z.keyframes,A=Z.css,E=A({label:"logo",display:"block",fill:"black",width:70,height:30}),H=function(){return Object(c.h)("svg",{className:E,viewBox:"0 0 196.07 71.15"},Object(c.h)("path",{d:"M93.4 55.8c-8.7-.2-15.5-7.5-15.3-16.1v-5.1c-.2.3-.4.5-.7.6-.2.1-.4.1-.6.1-.3 0-.7-.1-1-.4-1.2-1-2.7-1.6-4.3-1.6h-.1c-3.5 0-6.4 2.9-6.5 6.4V54c0 .8-.7 1.5-1.5 1.5h-6.8c-.6 0-1.2-.4-1.4-1-.1.2-.2.4-.4.6-.3.2-.6.4-1 .4h-.2c-.4-.1-3.8-.5-5.9-2.5-2.6 1.6-5.7 2.5-8.7 2.5h-.2c-8.8 0-16-7.1-16.1-15.9.1-8.8 7.4-16 16.1-16h.4c8 0 14.8 6 15.9 13.7V28c0-.4.2-.8.5-1.1.3-.3.6-.4 1-.4h.1c1.5.1 2.9.5 4.3 1.1 3-2.4 6.7-3.8 10.5-3.8 2 0 4 .4 5.9 1.1.6.2 1 .8 1 1.4v.4c.1-.2.2-.3.4-.5.3-.2.6-.3.9-.3h.4c2.7.7 7.9 3.7 8 10.3v4.1c.2 3.1 2.8 5.5 5.9 5.5h.4c3.2-.2 5.7-3 5.5-6.3v-7.1-.2c.4-6.5 5.6-8.8 7.3-9.6l.3-.1c.2-.1.4-.1.6-.1h.1c.7 0 1.3.5 1.5 1.1v-6.8c0-.8.7-1.5 1.5-1.5h.2c.2 0 .4 0 .6.1l.2.1c1.7.8 6.7 3.1 7.1 9.6 2.1-.9 4.3-1.4 6.7-1.4h.2c7.3 0 13.5 4.9 15.5 11.6 2-6.7 8.2-11.6 15.5-11.6h.4c8.8 0 16 7.1 16.1 15.9v14.4c0 .4-.2.8-.5 1.1-.3.2-.6.4-1 .4h-.2c-.4-.1-3.8-.5-5.9-2.5-2.6 1.6-5.7 2.5-8.7 2.5h-.2c-7.3 0-13.5-4.9-15.5-11.6-2 6.7-8.2 11.6-15.5 11.6h-.2c-3 0-5.9-.8-8.5-2.3-2.2 1.9-5.7 2.4-6.2 2.4h-.2c-.4 0-.7-.1-1-.4-.3-.3-.5-.7-.5-1.1V41.4c-.7 8.1-7.4 14.4-15.6 14.4h-.6zM39.1 33.2c-3.5 0-6.4 2.8-6.5 6.3-.1 3.6 2.7 6.6 6.3 6.7h.1c3.6 0 6.5-2.9 6.5-6.5 0-3.5-2.8-6.4-6.3-6.5h-.1zm86.9 0c-3.5 0-6.4 2.8-6.5 6.3-.1 3.6 2.7 6.6 6.3 6.7h.1c3.6 0 6.5-2.9 6.5-6.5 0-3.5-2.8-6.4-6.3-6.5h-.1zm31.4 0c-3.5 0-6.4 2.8-6.5 6.3-.1 3.6 2.7 6.6 6.3 6.7h.1c3.6-.1 6.5-3 6.6-6.5 0-3.5-2.8-6.4-6.3-6.5h-.2z"}),Object(c.h)("path",{d:"M111.1 16.9c1.3.6 6.2 2.6 6.5 8.6v2.2c2.4-1.6 5.3-2.4 8.1-2.4h.2c8 0 14.5 6.4 14.6 14.4-.1 8-6.6 14.4-14.6 14.4h-.2c-3.1 0-6.2-1-8.7-2.8-1.7 2.4-6.1 2.9-6.1 2.9V16.9h.2m14.8 30.8c4.4 0 8.1-3.6 8.1-8 0-4.3-3.5-7.9-7.8-8h-.2c-4.3 0-7.9 3.4-8 7.8-.1 4.4 3.4 8.1 7.8 8.2h.1M108 24v16.4c-.2 7.7-6.5 13.8-14.2 13.8h-.4c-7.8-.2-14-6.7-13.8-14.6V27.4s6.8 1.7 6.8 8.9v4.2c.2 3.9 3.5 6.9 7.4 6.9h.5c4.1-.3 7.2-3.8 6.9-7.8v-7c.3-6 5.4-7.9 6.7-8.6h.1m49 1.3h.4c8 0 14.5 6.4 14.6 14.4v14.4s-4.3-.5-5.8-3c-2.6 1.9-5.8 3-9 3h-.2c-8 0-14.5-6.4-14.6-14.4.1-8 6.6-14.4 14.6-14.4m.3 22.4c4.4 0 8.1-3.6 8.1-8 0-4.3-3.5-7.9-7.8-8h-.2c-4.3 0-7.9 3.4-8 7.8-.1 4.4 3.4 8.1 7.8 8.2h.1M38.7 25.3h.4c8 0 14.5 6.4 14.6 14.4v14.4s-4.3-.5-5.8-3c-2.6 1.9-5.8 3-9 3h-.2c-8 0-14.5-6.4-14.6-14.4.1-8 6.6-14.4 14.6-14.4m.3 22.4c4.4 0 8.1-3.6 8.1-8 0-4.3-3.5-7.9-7.8-8h-.2c-4.3 0-7.9 3.4-8 7.8-.1 4.4 3.4 8.1 7.8 8.2h.1m32.4-22.4s.1 0 0 0c1.9 0 3.6.4 5.3 1v7.6c-1.5-1.3-3.4-1.9-5.3-1.9h-.1c-4.4 0-7.9 3.5-8 7.9v14.3h-6.8V28c1.6.1 3.2.6 4.6 1.4 2.8-2.7 6.5-4.1 10.3-4.1m39.7-11.4h-.1c-1.7 0-3 1.3-3 3V21h-.1c-.5 0-.9.1-1.3.3l-.3.1c-5.1 2.4-7.9 6-8.1 10.9v7.4c.2 2.4-1.7 4.5-4.1 4.7h-.3c-2.3 0-4.2-1.8-4.4-4.1v-.6-3.5c-.1-7.6-6-11-9.1-11.8-.2-.1-.5-.1-.7-.1h-.5c-.3-.4-.8-.8-1.3-.9-2-.8-4.2-1.2-6.4-1.2h-.1c-3.9 0-7.7 1.2-10.8 3.5-1.3-.5-2.6-.8-4-.8h-.2c-.8 0-1.5.3-2.1.8-.6.6-.9 1.4-.9 2.2v1.9c-3.2-4.6-8.5-7.6-14.4-7.6h-.4c-9.6 0-17.5 7.8-17.6 17.4v.1c.1 9.6 8 17.4 17.6 17.4h.2c3 0 5.9-.8 8.6-2.2 2.4 1.7 5.4 2.1 5.9 2.2h.4c.5 0 1-.1 1.4-.4.4.2.9.4 1.4.4h6.8c1.7 0 3-1.3 3-3V39.8c0-2.7 2.3-4.9 5-4.9h.2c1.2 0 2.4.4 3.4 1.2.5.4 1.1.7 1.8.7v2.8c-.1 4.6 1.6 8.9 4.7 12.3 3.2 3.3 7.4 5.2 12 5.4h.5c5.9 0 11.1-2.9 14.1-7.4v4.3c0 .9.4 1.7 1 2.2.6.5 1.3.8 2 .8h.3c.7-.1 3.7-.5 6.2-2.1 2.6 1.3 5.4 2 8.3 2h.2c6.6 0 12.5-3.7 15.5-9.2 3 5.5 8.8 9.2 15.5 9.2h.3c3 0 5.9-.8 8.6-2.2 2.4 1.7 5.4 2.1 5.9 2.2h.4c.7 0 1.4-.3 2-.8.6-.6 1-1.4 1-2.2V39.7c-.1-9.6-8-17.4-17.6-17.4h-.4c-6.6 0-12.5 3.7-15.5 9.2-3-5.5-8.8-9.2-15.5-9.2h-.2c-1.8 0-3.7.3-5.4.8-.8-3.9-3.4-6.9-7.7-8.9l-.2-.1c-.6-.1-1-.2-1.5-.2zm46.3 30.8h-.2c-2.8-.1-4.9-2.4-4.9-5.1.1-2.7 2.3-4.9 5-4.9h.1c2.7.1 4.9 2.3 4.9 5 .1 2.7-2.2 4.9-4.9 5zm-31.3 0h-.2c-2.8-.1-4.9-2.4-4.9-5.1.1-2.7 2.3-4.9 5-4.9h.1c2.7.1 4.9 2.3 4.9 5s-2.2 4.9-4.9 5zm-87 0h-.2c-1.3 0-2.6-.6-3.5-1.6-.9-1-1.4-2.2-1.4-3.6.1-2.7 2.3-4.9 5-4.9h.1c2.7.1 4.9 2.3 4.9 5 .1 2.8-2.1 5-4.9 5.1z",fill:"#fff"}))},W=A({label:"watermark",overflow:"hidden",position:"absolute",transform:"translate(-50%, 0)",opacity:.4,zIndex:1,left:"50%",top:0}),V=function(){return Object(c.h)("div",{className:W},Object(c.h)(H,null))},G=A(_.shadow,_.rounded,{position:"absolute",display:"flex",flexDirection:"column",zIndex:1,right:15,bottom:15}),K=A(_.buttonReset,_.focusRing,_.buttonHoverActive,_.rounded,{cursor:"pointer",padding:4,width:40,height:40,border:0,fontSize:20,fontWeight:200,fill:L.brandBrightBlue,background:"white"}),Y=A(K,{borderBottomLeftRadius:0,borderBottomRightRadius:0,borderBottom:"1px solid "+L.buttonSeparatorColor}),J=A(K,{borderTopLeftRadius:0,borderTopRightRadius:0}),Q=function(e){var t=e.onClick;return"in"===e.dir?Object(c.h)("button",{className:U("meridian-zoom-button","meridian-zoom-button-in",Y),onClick:t},Object(c.h)("svg",{viewBox:"0 0 36 36"},Object(c.h)("path",{d:"M26 17h-7v-7a1 1 0 0 0-2 0v7h-7a1 1 0 0 0 0 2h7v7a1 1 0 0 0 2 0v-7h7a1 1 0 0 0 0-2"}))):Object(c.h)("button",{className:U("meridian-zoom-button","meridian-zoom-button-out",J),onClick:t},Object(c.h)("svg",{viewBox:"0 0 36 36"},Object(c.h)("path",{d:"M26 19H10a1 1 0 0 1 0-2h16a1 1 0 0 1 0 2"})))};Q.propTypes={zoomD3:M.a.node,dir:M.a.oneOf(["in","out"])};var X=function(e){var t=e.onZoomIn,o=e.onZoomOut;return Object(c.h)("div",{className:U("meridian-zoom-controls",G)},Object(c.h)(Q,{onClick:t,dir:"in"}),Object(c.h)(Q,{onClick:o,dir:"out"}))};X.propTypes={onZoomIn:M.a.func,onZoomOut:M.a.func};var $=X,ee=o(21),te=o.n(ee),oe="https://files.meridianapps.com/meridian-web-sdk-assets/0.2.0",ne={enDash:"â€“",unnamedBuilding:"Unassigned",noResultsFound:"No results found."};function re(e){return function(t){return t.toLowerCase().indexOf(e.toLowerCase().trim())>=0}}function ae(e){return e.editor_data.tags.map(function(e){return e.name})}function ie(e,t){console.error(e+": argument `"+t+"` is required")}function le(e){for(var t=arguments.length,o=Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];setTimeout.apply(void 0,[e,0].concat(o))}function se(e){return oe+"/"+e}function ce(e){return se("placemarks/"+("placemark-"+e.replace(/_/g,"-"))+".svg")}var ue,de,pe=(ue=s()(i.a.mark(function e(t,o){var n,r,a,l,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get(o);case 2:n=e.sent,r=n.data,a=r.results,l=r.next;case 6:if(!l){e.next=15;break}return e.next=9,t.axios.get(l);case 9:s=e.sent,c=s.data,a.push.apply(a,k()(c.results)),l=c.next,e.next=6;break;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e,this)})),function(e,t){return ue.apply(this,arguments)}),he=(de=s()(i.a.mark(function e(t){var o=t.api,n=t.locationID,r=t.floorID;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new te.a(function(e){var t=o.openStream({locationID:n,floorID:r,onInitialTags:function(o){e(o),t.close()}})}));case 1:case"end":return e.stop()}},e,this)})),function(e){return de.apply(this,arguments)});var fe=A(_.buttonReset,_.rounded,_.overflowEllipses,{label:"floor-control",background:"rgba(0, 0, 0, 0.4)",color:"white",textShadow:"0 0 2px black",position:"absolute",zIndex:1,bottom:15,left:"50%",transform:"translate(-50%, 0)",textAlign:"center",maxWidth:300,padding:"8px 16px",border:0,fontSize:16}),ge=function(e){var t=e.buildingName,o=e.floorName;return Object(c.h)("div",{className:U("meridian-floor-label",fe)},t||ne.unnamedBuilding," ",ne.enDash," ",o)};ge.propTypes={buildingName:M.a.string.isRequired,floorName:M.a.string.isRequired};var me=ge,ve=o(13),be=o.n(ve),ke=function(){return Object(c.h)("svg",{viewBox:"0 0 36 36"},Object(c.h)("path",{d:"M19.41 18l6.36-6.36a1 1 0 0 0-1.41-1.41L18 16.59l-6.36-6.36a1 1 0 0 0-1.41 1.41L16.59 18l-6.36 6.36a1 1 0 1 0 1.41 1.41L18 19.41l6.36 6.36a1 1 0 0 0 1.41-1.41z"}))},ye=A(_.shadow,_.rounded,{label:"overlay",overflow:"hidden",display:"flex",flexDirection:"column",background:L.white,color:L.textColor,fill:"#000",position:"absolute",margin:0,left:15,top:15,right:15,maxHeight:"calc(100vh - 30px)",zIndex:2,maxWidth:400}),Oe=A(ye,{marginRight:"auto"}),xe=A(ye,{marginLeft:"auto"}),Ce=A(_.buttonReset,_.buttonHoverActive,_.focusRing,{label:"overlay-close",cursor:"pointer",position:"absolute",zIndex:2,top:10,right:10,padding:4,width:32,height:32,fontSize:11,textAlign:"center",background:L.white,color:L.textColor,borderRadius:"100%",fontWeight:"bold",boxShadow:"0 0 2px rgba(0, 0, 0, 0.4)"}),we=function(e){var t=e.onClick;return Object(c.h)("button",{className:Ce,onClick:t},Object(c.h)(ke,null))};we.propTypes={onClick:M.a.func.isRequired};var Ie=function(e){var t=e.position,o=e.onCloseClicked,n=e.children;return Object(c.h)("div",{className:"left"===t?Oe:xe},Object(c.h)(we,{onClick:o}),n)};Ie.propTypes={position:M.a.oneOf(["left","right"]).isRequired,children:M.a.node.isRequired,onCloseClicked:M.a.func.isRequired};var Se=Ie,Te=A(_.buttonReset,_.rounded,_.focusRing,{label:"overlay-search-input",flex:"1 1 auto",marginRight:42,fontSize:16,padding:"4px 8px",paddingLeft:30,background:L.borderColor,color:L.black,border:0,"&::placeholder":{color:L.textColorBluish}}),je=A({label:"overlay-search-icon",position:"absolute",zIndex:1,fill:L.textColorBluish,width:16,height:16,top:18,left:18}),Re=function(e){return Object(c.h)("svg",r()({viewBox:"0 0 15 15"},e),Object(c.h)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.2454 12.5741L9.55123 8.73956C10.2134 7.80246 10.5682 6.66953 10.5632 5.50756C10.5506 2.47441 8.18614 0.0175744 5.26286 5.57178e-05C3.8639 -0.00651157 2.52051 0.567712 1.53197 1.59481C0.543427 2.6219 -0.0081584 4.01655 9.12228e-05 5.46806C0.0127262 8.50148 2.37737 10.9585 5.30093 10.9761C6.42539 10.9811 7.52128 10.6088 8.42505 9.91456L8.4289 9.91156L12.1197 13.7431C12.3193 13.9603 12.6166 14.0482 12.8966 13.9728C13.1765 13.8973 13.395 13.6704 13.4675 13.3799C13.5399 13.0894 13.455 12.7809 13.2454 12.5741ZM5.29738 9.87819C2.95866 9.86423 1.06697 7.8988 1.05671 5.47219C1.0504 4.31114 1.4917 3.19564 2.28239 2.37403C3.07307 1.55242 4.14751 1.09287 5.26653 1.09769C7.60525 1.11165 9.49694 3.07709 9.5072 5.50369C9.51352 6.66475 9.07221 7.78024 8.28152 8.60186C7.49084 9.42347 6.4164 9.88302 5.29738 9.87819Z",transform:"translate(0.637695)"}))},De=A({label:"overlay-search-bar",position:"relative",zIndex:1,flex:"0 0 auto",display:"flex",flexDirection:"column",padding:10,height:32}),Me=function(e){function t(e){C()(this,t);var o=T()(this,(t.__proto__||O()(t)).call(this,e));return o.input=null,o}return R()(t,e),I()(t,[{key:"componentDidMount",value:function(){this.input&&this.input.focus()}},{key:"render",value:function(){var e=this,t=this.props,o=t.value,n=t.onChange,r=void 0===n?function(){}:n;return Object(c.h)("div",{className:De},Object(c.h)(Re,{className:je}),Object(c.h)("input",{value:o,type:"text",placeholder:"Search",className:Te,onInput:function(e){r(e.target.value)},ref:function(t){e.input=t}}))}}]),t}(c.Component);Me.propTypes={value:M.a.string.isRequired,onChange:M.a.func};var ze=Me,Fe=A({label:"overlay-building-name",textTransform:"uppercase",fontWeight:"bold",top:0,position:"sticky",color:L.brandBlue,background:L.almostWhite,fontSize:L.fontSizeSmaller,padding:10}),qe=A({label:"floors-list",overflowY:"auto"}),Be=A(_.buttonReset,_.focusRingMenuItem,_.buttonHoverActive,{label:"overlay-floor-button",padding:10,paddingLeft:20,display:"block",width:"100%",textAlign:"left"}),Le=A({label:"overlay-floor-list-empty",padding:"60px 20px",textAlign:"center",fontSize:L.fontSizeBigger,color:L.textColorBluish}),_e=A({label:"overlay-floor-button-curent-floor",color:L.brandBrightBlue,fill:"currentcolor"}),Ne=A({label:"floor-checkmark",verticalAlign:"middle",marginLeft:"0.5em",width:"0.8em",height:"0.8em"}),Ze=function(){return Object(c.h)("svg",{viewBox:"0 0 10 7",className:Ne},Object(c.h)("path",{d:"M3.9 7C3.7 7 3.4 6.9 3.2 6.7L0.3 3.8C-0.1 3.4 -0.1 2.8 0.3 2.4C0.7 2 1.3 2 1.7 2.4L3.9 4.6L8.2 0.3C8.6 -0.1 9.2 -0.1 9.6 0.3C10 0.7 10 1.3 9.6 1.7L4.6 6.7C4.4 6.9 4.2 7 3.9 7Z"}))},Ue=function(e){function t(e){C()(this,t);var o=T()(this,(t.__proto__||O()(t)).call(this,e));return o.handleSearchFilterChange=function(e){o.setState({searchFilter:e.target.value})},o.state={searchFilter:""},o.searchInput=null,o}return R()(t,e),I()(t,[{key:"componentDidMount",value:function(){this.searchInput&&this.searchInput.focus()}},{key:"processedFloorsByBuilding",value:function(){var e=this.state.searchFilter,t=this.props.floors,o=re(e);return t.filter(function(e){return o(e.name||"")||o(e.group_name||ne.unnamedBuilding)})}},{key:"renderList",value:function(){var e=this.props,t=e.currentFloorID,o=e.toggleFloorOverlay,n=e.selectFloorByID,r=this.processedFloorsByBuilding(),a=be()(r,"group_name"),i=g()(a).sort();""===i[0]&&i.push(i.shift());var l=!0,s=!1,u=void 0;try{for(var d,p=h()(i);!(l=(d=p.next()).done);l=!0){var f=d.value;a[f].sort(function(e,t){return e.level-t.level})}}catch(e){s=!0,u=e}finally{try{!l&&p.return&&p.return()}finally{if(s)throw u}}return i.length>0?Object(c.h)("div",{className:qe},i.map(function(e){return Object(c.h)("div",{key:e},Object(c.h)("div",{className:Fe},e||ne.unnamedBuilding),a[e].map(function(e){return Object(c.h)("button",{key:e.name,onClick:function(){n(e.id),o({open:!1})},className:U(Be,e.id===t&&_e)},e.name,e.id===t?Object(c.h)(Ze,null):null)}))})):Object(c.h)("div",{className:Le},ne.noResultsFound)}},{key:"render",value:function(){var e=this,t=this.state.searchFilter,o=this.props.toggleFloorOverlay;return Object(c.h)(Se,{position:"right",onCloseClicked:function(){o({open:!1})}},Object(c.h)(ze,{value:t,onChange:function(t){e.setState({searchFilter:t})}}),this.renderList())}}]),t}(c.Component);Ue.propTypes={toggleFloorOverlay:M.a.func.isRequired,currentFloorID:M.a.string.isRequired,floors:M.a.object.isRequired,selectFloorByID:M.a.func.isRequired,closeFloorOverlay:M.a.func.isRequired};var Pe=Ue,Ae=o(20),Ee=o.n(Ae),He=o(19),We=P(o.n(He)()(["\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n"],["\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n"])),Ve=A({label:"spinner",width:22,height:22,margin:"0 auto",border:"2px rgba(227, 227, 227, 0.9) solid",borderTop:"2px #2e7cbe solid",borderRadius:"50%",animation:We+" 600ms infinite linear"}),Ge=function(){return Object(c.h)("div",{className:Ve})},Ke=A(_.maxRounded,{label:"label",display:"inline-block",padding:"3px 8px",marginBottom:8,marginRight:8,background:"rgba(0, 0, 0, 0.035)",color:"#3b3b3b"}),Ye=function(e){var t=e.name;return Object(c.h)("div",{className:Ke},t)};Ye.propTypes={name:M.a.string.isRequired};var Je=function(e){var t=e.align,o=e.labels,n=e.fontSize,r=void 0===n?L.fontSize:n;return 0===o.length?null:Object(c.h)("div",{className:function(e){var t=e.align,o=e.fontSize;return A({label:"label-list",fontSize:o,marginTop:8,textAlign:t,flex:"1 1 auto"})}({align:t,fontSize:r})},o.map(function(e,t){return Object(c.h)(Ye,{key:t,name:e})}))};Je.propTypes={fontSize:M.a.string,align:M.a.oneOf(["left","right"]).isRequired,labels:M.a.arrayOf(M.a.string).isRequired};var Qe=Je,Xe=A({label:"overlay-building-name",top:0,position:"sticky",textTransform:"uppercase",fontWeight:"bold",color:L.brandBlue,background:L.almostWhite,fontSize:L.fontSizeSmaller,padding:10}),$e=A({label:"tags-list",overflowY:"auto",flex:"1 1 auto"}),et=A(_.buttonReset,_.focusRingMenuItem,_.buttonHoverActive,{label:"overlay-tags-button",minHeight:56,padding:10,paddingLeft:20,display:"block",width:"100%",textAlign:"left"}),tt=A(_.flexRow,{label:"overlay-tags-button-inner",alignItems:"center"}),ot=A({label:"overlay-tags-button-name",flex:"1 0 auto"}),nt=A({label:"overlay-tags-list-empty",padding:"60px 20px",textAlign:"center",fontSize:L.fontSizeBigger,color:L.textColorBluish}),rt=function(e){function t(e){C()(this,t);var o=T()(this,(t.__proto__||O()(t)).call(this,e));return o.state={searchFilter:""},o.searchInput=null,o}return R()(t,e),I()(t,[{key:"componentDidMount",value:function(){this.searchInput&&this.searchInput.focus()}},{key:"getFloorToGroup",value:function(){var e=this.props.floors,t={},o=!0,n=!1,r=void 0;try{for(var a,i=h()(e);!(o=(a=i.next()).done);o=!0){var l=a.value;t[l.id]=[l.group_name||ne.unnamedBuilding,ne.enDash,l.name].join(" ")}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}return t}},{key:"getOrganizedTags",value:function(e){var t=this.getFloorToGroup();return be()(e,function(e){return t[e.calculations.default.location.map_id]})}},{key:"getSortedGroups",value:function(e){var t=this.props.currentFloorID,o=g()(e).sort();return o.forEach(function(n,r){if(e[n][0].calculations.default.location.map_id===t){var a=o.splice(r,1),i=Ee()(a,1)[0];o.unshift(i)}}),o}},{key:"renderTagList",value:function(){var e=this.props,t=e.updateMap,o=e.tagOptions,n=e.tags,a=e.loading,i=e.onMarkerClick,l=e.toggleTagListOverlay,s=this.state.searchFilter;if(a)return Object(c.h)("div",{className:nt},Object(c.h)(Ge,null));var u=re(s),d=n.filter(function(e){return u(e.editor_data.name)||u(e.mac)||ae(e).some(u)}).filter(function(e){return!0===o.showControlTags||!e.editor_data.is_control_tag}).sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0});if(0===d.length)return Object(c.h)("div",{className:nt},ne.noResultsFound);var p=this.getOrganizedTags(d),h=this.getSortedGroups(p);return Object(c.h)("div",{className:$e},h.map(function(e){return Object(c.h)("div",{key:e},Object(c.h)("div",{className:Xe},e),p[e].map(function(e){return Object(c.h)("button",{key:e.id,className:et,onClick:function(){t({locationID:e.calculations.default.location.location_id,floorID:e.calculations.default.location.map_id,tags:r()({},o,{filter:function(){return!0}})}),i(e),l({open:!1})}},Object(c.h)("div",{className:tt},Object(c.h)("div",{className:ot},e.editor_data.name),Object(c.h)(Qe,{align:"right",labels:ae(e),fontSize:L.fontSizeSmallest})))}))}))}},{key:"render",value:function(){var e=this,t=this.state.searchFilter,o=this.props.toggleTagListOverlay;return Object(c.h)(Se,{position:"right",onCloseClicked:function(){o({open:!1})}},Object(c.h)(ze,{value:t,onChange:function(t){e.setState({searchFilter:t})}}),this.renderTagList())}}]),t}(c.Component);rt.propTypes={onMarkerClick:M.a.func.isRequired,loading:M.a.bool.isRequired,tags:M.a.arrayOf(M.a.object).isRequired,showControlTags:M.a.bool.isRequired,floors:M.a.object.isRequired,tagOptions:M.a.object.isRequired,updateMap:M.a.func.isRequired,api:M.a.object.isRequired,locationID:M.a.string.isRequired,currentFloorID:M.a.string.isRequired,toggleTagListOverlay:M.a.func.isRequired};var at=rt,it=A({label:"overlay-image",width:"100%",backgroundColor:"white",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}),lt=A({label:"overlay-name",fontSize:24}),st=A({label:"overlay-content",padding:"0 20px 10px 20px"}),ct=A({fontSize:14});var ut=function(e){var t=e.kind,o=e.item,n=e.toggleMapMarkerOverlay;return Object(c.h)(Se,{position:"left",onCloseClicked:function(){n({open:!1})}},Object(c.h)("div",{className:it,style:function(e){var t=e.kind,o=e.item;return"placemark"===t?{backgroundSize:"70%",backgroundImage:"url('"+ce(o.type)+"')",backgroundColor:"#"+o.color,height:300}:"tag"===t&&o.editor_data.image_url?{backgroundImage:"url('"+o.editor_data.image_url+"')",height:300}:{background:L.brandBrightBlue,height:300}}({kind:t,item:o})}),Object(c.h)("div",{className:st},Object(c.h)("p",{className:lt},("tag"===t?o.editor_data.name:o.name)||ne.enDash),"tag"===t?Object(c.h)("div",{className:ct},Object(c.h)(Qe,{align:"left",labels:ae(o),fontSize:L.fontSize}),Object(c.h)("p",null,"MAC: ",o.mac)):null))};ut.propTypes={kind:M.a.oneOf(["tag","placemark"]),item:M.a.object.isRequired,toggleMapMarkerOverlay:M.a.func.isRequired};var dt=ut,pt=A({label:"loading",position:"absolute",zIndex:3,width:30,left:0,top:"45%",right:0,overflow:"hidden",margin:"0 auto",color:L.textColor,textAlign:"center",pointerEvents:"none"}),ht=function(){return Object(c.h)("div",{className:pt},Object(c.h)(Ge,null))},ft=A(_.rounded,{label:"error",position:"absolute",zIndex:4,top:"35%",left:0,right:0,margin:"0 auto",minWidth:300,maxWidth:420,border:"1px solid #dfe1ef",paddingTop:15,paddingRight:20,paddingBottom:15,paddingLeft:25,background:L.white,boxShadow:"0 0 1px rgba(0, 0, 0, 0.15), inset 4px 0 0 #d82e1f"}),gt=A(_.buttonReset,{label:"close",cursor:"pointer",float:"right",width:38,height:38,marginLeft:15,padding:4,fill:"#c3c5c8","&:hover":{fill:L.textColorBluish,cursor:"pointer"},"&:focus":{outline:0}}),mt=function(e){var t=e.toggleErrorOverlay;return Object(c.h)("button",{className:gt,onClick:function(){t({open:!1})}},Object(c.h)(ke,null))};mt.propTypes={toggleErrorOverlay:M.a.func.isRequired};var vt=function(e){var t=e.toggleErrorOverlay,o=e.messages,n=void 0===o?["Unknown"]:o;return Object(c.h)("div",{className:ft},Object(c.h)(mt,{toggleErrorOverlay:t}),Object(c.h)("p",null,"Sorry, something went wrong. It might be related to:"),Object(c.h)("ul",null,n.map(function(e,t){return Object(c.h)("li",{key:t},e)})))};vt.propTypes={toggleErrorOverlay:M.a.func.isRequired,messages:M.a.array};var bt=vt,kt=o(18),yt=o.n(kt),Ot=se("tags/tag.svg"),xt=A(_.shadow,_.buttonReset,_.pointer,_.focusNone,{label:"meridian-tag",width:48,height:48,borderRadius:"100%",position:"absolute",backgroundColor:"white",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover",border:"2px solid white",overflow:"hidden",transition:"\n      width 80ms ease,\n      height 80ms ease,\n      top 500ms ease,\n      left 500ms ease\n    ",zIndex:2}),Ct=A(xt,{width:60,height:60,zIndex:3,boxShadow:"0 0 0 2px white, 0 0 4px black"}),wt=function(e){var t=e.isSelected,o=e.data,n=e.mapZoomFactor,r=e.onClick,a=void 0===r?function(){}:r,i=e.disabled,l=void 0!==i&&i,s=1/n/(n<.2?1.4:1),u=ae(o).map(function(e){return"meridian-tag-label-"+e.replace(/ /g,"-").replace(/[^a-z0-9_-]/i,"")}),d=t?U("meridian-tag-selected",u,Ct):U("meridian-tag",u,xt),p={left:o.calculations.default.location.x,top:o.calculations.default.location.y,transform:"translate(-50%, -50%) scale("+s+")",backgroundImage:"url('"+(o.editor_data.image_url||Ot)+"')"};return Object(c.h)("button",{disabled:l,className:d,style:p,onClick:function(e){e.target.focus(),a()},onMouseDown:function(e){e.stopPropagation()}})};wt.propTypes={isSelected:M.a.bool.isRequired,mapZoomFactor:M.a.number.isRequired,data:M.a.object.isRequired,onClick:M.a.func,disabled:M.a.bool};var It=wt,St=A({label:"meridian-placemark",position:"absolute"}),Tt=A(_.buttonReset,_.pointer,_.focusNone,{label:"meridian-placemark-icon",transition:"width 80ms ease, height 80ms ease",display:"block",width:24,height:24,borderRadius:"100%",backgroundColor:L.brandBlue,backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover",border:"2px solid transparent",overflow:"hidden",zIndex:1}),jt=A(Tt,{zIndex:3,width:30,height:30,boxShadow:"0 0 4px black"}),Rt=A(_.textStrokeWhite,{label:"meridian-label",marginLeft:"50%",position:"absolute",minWidth:55,maxWidth:120,fontSize:14,textAlign:"center",paddingTop:4,color:"black",userSelect:"none",transform:"translate(-50%, 0)",fontWeight:"bold"}),Dt=A({label:"meridian-label-only",textTransform:"uppercase",color:"#666",fontSize:16}),Mt=function(e){var t=e.isSelected,o=e.data,n=e.mapZoomFactor,r=e.onClick,a=void 0===r?function(){}:r,i=e.disabled,l=void 0!==i&&i,s=!o.type||0===o.type.indexOf("label_"),u=1/n/(n<.2?1.4:1),d="meridian-placemark-type-"+o.type,p=t?U("meridian-placemark-icon-selected",d,jt):U("meridian-placemark-icon",d,Tt),h={left:o.x,top:o.y,transform:"translate(-50%, -50%) scale("+u+")"};return s?Object(c.h)("div",{className:U("meridian-placemark",St),style:h},Object(c.h)("div",{className:U(Rt,Dt,"meridian-label","meridian-label-only")},o.name)):Object(c.h)("div",{className:U("meridian-placemark",St),style:h},Object(c.h)("button",{disabled:l,className:p,style:function(e){var t="#"+e.color;return{borderColor:t,backgroundColor:t,backgroundImage:"url('"+ce(e.type)+"')"}}(o),onClick:function(e){e.target.focus(),a(e)},onMouseDown:function(e){e.stopPropagation()}}),Object(c.h)("div",{className:U("meridian-label",Rt),style:{visibility:n<.2?"hidden":""}},o.name))};Mt.propTypes={isSelected:M.a.bool.isRequired,mapZoomFactor:M.a.number.isRequired,data:M.a.object.isRequired,onClick:M.a.func,disabled:M.a.bool};var zt=Mt,Ft=function(e){var t=e.selectedItem,o=e.kind,n=e.data,r=e.mapZoomFactor,a=e.disabled,i=e.onClick,l=void 0===i?function(){}:i;return"tag"===o?Object(c.h)(It,{isSelected:!!t&&t.mac===n.mac,mapZoomFactor:r,data:n,onClick:function(){l(n)},disabled:a}):"placemark"===o?Object(c.h)(zt,{isSelected:!!t&&t.id===n.id,mapZoomFactor:r,data:n,onClick:function(){l(n)},disabled:a}):null};Ft.propTypes={selectedItem:M.a.object.isRequired,mapZoomFactor:M.a.number.isRequired,kind:M.a.string.isRequired,data:M.a.object.isRequired,onClick:M.a.func,disabled:M.a.bool};var qt=Ft,Bt=function(e){function t(e){C()(this,t);var o=T()(this,(t.__proto__||O()(t)).call(this,e));return o.commitTagUpdates=yt()(function(){o.setState(function(e){return{tagsByMAC:r()({},e.tagsByMAC,o.tagUpdates)}},function(){o.tagUpdates={},o.onUpdate()})},1e3),o.onUpdate=function(){var e=o.props,t=e.onUpdate,n=e.markers.filter,r=void 0===n?function(){return!0}:n,a=o.filterControlTags(o.getTags());t({allTags:a,filteredTags:a.filter(r)})},o.state={tagsByMAC:{},connection:null},o.tagUpdates={},o}return R()(t,e),I()(t,[{key:"componentDidMount",value:function(){this.props.markers&&this.connect()}},{key:"shouldComponentUpdate",value:function(e){var t=e.mapZoomFactor!==this.props.mapZoomFactor;return!(this.props.isPanningOrZooming&&!t)}},{key:"componentDidUpdate",value:function(e){e.floorID!==this.props.floorID&&(this.disconnect(),this.connect())}},{key:"componentWillUnmount",value:function(){this.disconnect()}},{key:"getTags",value:function(){var e=this.state.tagsByMAC,t=[],o=!0,n=!1,r=void 0;try{for(var a,i=h()(g()(e));!(o=(a=i.next()).done);o=!0){var l=a.value;t.push(e[l])}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}return t}},{key:"removeTag",value:function(e){this.setState(function(t){var o=t.tagsByMAC;return{tagsByMAC:g()(o).filter(function(t){return t!==e.mac}).reduce(function(e,t){return e[t]=o[t],e},{})}})}},{key:"handleTagUpdates",value:function(e){var t=this.props.isPanningOrZooming;this.tagUpdates=r()({},this.tagUpdates,this.tagsByMAC(e)),t||this.commitTagUpdates()}},{key:"tagsByMAC",value:function(e){return e.reduce(function(e,t){return e[t.mac]=t,e},{})}},{key:"setInitialTags",value:function(e){var t=this;this.setState({tagsByMAC:this.tagsByMAC(e)},function(){t.onUpdate(),t.props.toggleLoadingSpinner({show:!1,source:"tags"})})}},{key:"connect",value:function(){var e=this,t=this.props,o=t.floorID,n=t.locationID,r=t.api;(0,t.toggleLoadingSpinner)({show:!0,source:"tags"});var a=r.openStream({locationID:n,floorID:o,onInitialTags:function(t){e.setInitialTags(t)},onTagDisappear:function(t){e.removeTag(t)},onTagUpdate:function(t){e.handleTagUpdates([t])},onClose:function(){e.setState({connection:null},function(){e.onUpdate()})}});this.setState({connection:a},function(){e.onUpdate()})}},{key:"disconnect",value:function(){var e=this.state.connection;e&&(e.close(),this.tagUpdates={},this.setState({tagsByMAC:{}}))}},{key:"filterControlTags",value:function(e){var t=this.props.markers;return e.filter(function(e){return!0===t.showControlTags||!e.editor_data.is_control_tag})}},{key:"filterTags",value:function(e){var t=this.props.markers.filter,o=void 0===t?function(){return!0}:t;return this.filterControlTags(e).filter(o)}},{key:"render",value:function(){var e=this.props,t=e.selectedItem,o=e.markers,n=e.onMarkerClick,r=e.mapZoomFactor,a=this.filterTags(this.getTags()).map(function(e){return Object(c.h)(qt,{selectedItem:t,mapZoomFactor:r,key:e.mac,kind:"tag",data:e,onClick:n,disabled:o.disabled})});return Object(c.h)("div",null,a)}}]),t}(c.Component);Bt.defaultProps={markers:{},onUpdate:function(){}},Bt.propTypes={selectedItem:M.a.object.isRequired,isPanningOrZooming:M.a.bool.isRequired,mapZoomFactor:M.a.number.isRequired,locationID:M.a.string.isRequired,floorID:M.a.string.isRequired,api:M.a.object,markers:M.a.shape({filter:M.a.func,showControlTags:M.a.bool,disabled:M.a.bool}),onMarkerClick:M.a.func,onUpdate:M.a.func,toggleLoadingSpinner:M.a.func.isRequired};var Lt=Bt,_t=function(e){function t(){var e,o,n,r;C()(this,t);for(var a=arguments.length,i=Array(a),l=0;l<a;l++)i[l]=arguments[l];return o=n=T()(this,(e=t.__proto__||O()(t)).call.apply(e,[this].concat(i))),n.state={placemarksByID:{}},r=o,T()(n,r)}return R()(t,e),I()(t,[{key:"componentDidMount",value:function(){var e=s()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.updatePlacemarks();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(e){var t=e.mapZoomFactor!==this.props.mapZoomFactor;return!(this.props.isPanningOrZooming&&!t)}},{key:"componentDidUpdate",value:function(e){e.floorID!==this.props.floorID&&(this.setState({placemarksByID:{}}),this.updatePlacemarks())}},{key:"updatePlacemarks",value:function(){var e=s()(i.a.mark(function e(){var t,o,n,r,a,l,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,o=t.locationID,n=t.floorID,r=t.api,(a=t.toggleLoadingSpinner)({show:!0,source:"placemarks"}),l="locations/"+o+"/placemarks?map="+n,e.next=5,pe(r,l);case 5:s=e.sent,c=this.groupPlacemarksByID(s),this.setState({placemarksByID:c},function(){a({show:!1,source:"placemarks"})});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"normalizePlacemark",value:function(e){return r()({kind:"placemark"},e)}},{key:"groupPlacemarksByID",value:function(e){var t=this;return e.map(function(e){return t.normalizePlacemark(e)}).reduce(function(e,t){return e[t.id]=t,e},{})}},{key:"getFilterFunction",value:function(){var e=this.props.markers.filter;return void 0===e?function(){return!0}:e}},{key:"cullMarkers",value:function(e){return e}},{key:"render",value:function(){var e=this.state.placemarksByID,t=this.props,o=t.markers,n=t.onMarkerClick,r=t.mapZoomFactor,a=t.selectedItem,i=this.getFilterFunction(),l=g()(e).map(function(t){return e[t]}).filter(function(e){return!0===o.showHiddenPlacemarks||!e.hide_on_map}).filter(i),s=this.cullMarkers(l).map(function(e){return Object(c.h)(qt,{selectedItem:a,mapZoomFactor:r,key:e.id,kind:"placemark",data:e,onClick:n,disabled:o.disabled})});return Object(c.h)("div",null,s)}}]),t}(c.Component);_t.defaultProps={markers:{}},_t.propTypes={selectedItem:M.a.object.isRequired,isPanningOrZooming:M.a.bool.isRequired,mapZoomFactor:M.a.number.isRequired,locationID:M.a.string.isRequired,floorID:M.a.string.isRequired,api:M.a.object,markers:M.a.shape({showHiddenPlacemarks:M.a.bool,filter:M.a.func,disabled:M.a.bool}),onMarkerClick:M.a.func,toggleLoadingSpinner:M.a.func.isRequired};var Nt=_t,Zt=A({label:"floor-and-tag-controls",display:"flex",flexDirection:"column",position:"absolute",zIndex:1,right:15,top:15}),Ut=A(_.buttonReset,_.shadow,_.rounded,_.buttonHoverActive,_.focusRing,{label:"control",cursor:"pointer",background:"white",padding:4,width:40,height:40,border:0,fontSize:20,fontWeight:200,fill:L.brandBrightBlue}),Pt=A(Ut,{marginTop:10}),At=function(e){var t=e.toggleFloorOverlay,o=e.toggleTagListOverlay,n=e.showFloors,r=e.showTagList;return Object(c.h)("div",{className:Zt},r?Object(c.h)("button",{className:U("meridian-tag-control",Ut),onClick:function(){o({open:!0})}},Object(c.h)("svg",{viewBox:"-8 -10 36 36"},Object(c.h)("path",{d:"M2 4C0.9 4 0 3.1 0 2C0 0.9 0.9 0 2 0C3.1 0 4 0.9 4 2C4 3.1 3.1 4 2 4ZM4 8C4 6.9 3.1 6 2 6C0.9 6 0 6.9 0 8C0 9.1 0.9 10 2 10C3.1 10 4 9.1 4 8ZM4 14C4 12.9 3.1 12 2 12C0.9 12 0 12.9 0 14C0 15.1 0.9 16 2 16C3.1 16 4 15.1 4 14ZM20 2C20 1.4 19.6 1 19 1H8C7.4 1 7 1.4 7 2C7 2.6 7.4 3 8 3H19C19.6 3 20 2.6 20 2ZM20 8C20 7.4 19.6 7 19 7H8C7.4 7 7 7.4 7 8C7 8.6 7.4 9 8 9H19C19.6 9 20 8.6 20 8ZM20 14C20 13.4 19.6 13 19 13H8C7.4 13 7 13.4 7 14C7 14.6 7.4 15 8 15H19C19.6 15 20 14.6 20 14Z"}))):null,n?Object(c.h)("button",{className:U("meridian-floor-control",n&&r?Pt:Ut),onClick:function(){t({open:!0})}},Object(c.h)("svg",{viewBox:"0 0 36 36"},Object(c.h)("path",{d:"M28.4 14.09a1.84 1.84 0 0 0-.62-.39l-8.48-3.33a3.61 3.61 0 0 0-1.3-.22 3.56 3.56 0 0 0-1.3.22L8.22 13.7a1.83 1.83 0 0 0-.62.39 1.24 1.24 0 0 0 0 1.82 1.85 1.85 0 0 0 .62.39l8.48 3.34a3.92 3.92 0 0 0 2.59 0l8.48-3.34a1.86 1.86 0 0 0 .62-.39 1.24 1.24 0 0 0 0-1.82m-9.83 3.68a2 2 0 0 1-1.13 0l-7-2.77 7-2.77a2 2 0 0 1 1.13 0l7 2.77zm9.83 2.32a1.24 1.24 0 0 1 0 1.82 1.86 1.86 0 0 1-.62.39l-8.47 3.33a3.92 3.92 0 0 1-2.59 0L8.22 22.3a1.85 1.85 0 0 1-.62-.39 1.24 1.24 0 0 1 0-1.82 1.83 1.83 0 0 1 .62-.39L10 19l2.73 1.08-2.34.92 7 2.77a2 2 0 0 0 1.13 0l7-2.77-2.35-.92L26 19l1.79.7a1.84 1.84 0 0 1 .62.39"}))):null)};At.propTypes={showFloors:M.a.bool.isRequired,showTagList:M.a.bool.isRequired,toggleFloorOverlay:M.a.func.isRequired,toggleTagListOverlay:M.a.func.isRequired};var Et=At,Ht=o(17),Wt=o.n(Ht),Vt={development:"https://tags.meridianapps.com",production:"https://tags.meridianapps.com",eu:"https://tags-eu.meridianapps.com",staging:"https://staging-tags.meridianapps.com"},Gt={development:"http://localhost:8091/websdk/api",production:"https://edit.meridianapps.com/websdk/api",eu:"https://edit-eu.meridianapps.com/websdk/api",staging:"https://staging-edit.meridianapps.com/websdk/api"},Kt={const:"STREAM_ALL_FLOORS"},Yt=function(){function e(t){var o=t.environment,n=void 0===o?"production":o,r=t.token,a=void 0===r?ie("API","token"):r;C()(this,e),this.token=a,this.environment=n,this.axios=d.a.create({baseURL:Gt[this.environment],headers:{Authorization:"Token "+a}})}return I()(e,[{key:"openStream",value:function(e){var t=this,o=e.locationID,n=void 0===o?ie("openStream","locationID"):o,r=e.floorID,a=void 0===r?ie("openStream","floorID"):r,i=e.onInitialTags,l=void 0===i?function(){}:i,s=e.onTagUpdate,c=void 0===s?function(){}:s,u=e.onTagLeave,d=void 0===u?function(){}:u,p=e.onClose,h=void 0===p?function(){}:p,f=e.onException,g=void 0===f?function(){}:f,m=Wt.a.connect(Vt[this.environment],{path:"/streams/v1beta2/tracking/websocket",transports:["websocket"]});return m.on("connect",function(){m.emit("authenticate",{locationID:n,token:t.token})}),m.on("connect_error",h),m.on("disconnect",h),m.on("exception",g),m.on("authenticated",function(){a===Kt?m.emit("subscribe",{locationID:n}):m.emit("subscribe",{locationID:n,mapID:a})}),m.on("unauthenticated",h),m.on("assets",l),m.on("asset_update",c),m.on("asset_delete",d),{close:function(){return m.close()}}}}]),e}(),Jt=.5,Qt=250,Xt=-1!==window.navigator.userAgent.indexOf("MSIE ")||-1!==window.navigator.userAgent.indexOf("Trident/")||-1!==window.navigator.userAgent.indexOf("Edge/"),$t=A({label:"map-container",display:"block",position:"relative",borderRadius:"inherit",background:"#fafafa",color:"#000",fontFamily:"inherit",textAlign:"left"}),eo=A({label:"map-outer",borderRadius:"inherit",display:"block",overflow:"hidden"}),to=A({touchAction:"none"}),oo=function(e){function t(e){var o=this;C()(this,t);var n,a=T()(this,(t.__proto__||O()(t)).call(this,e));return a.updateMap=function(e){var t=a.props,o=t.update,n=t.onMapUpdate;o(e),n(e)},a.toggleTagListOverlay=function(e){var t=e.open;a.setState({isTagListOverlayOpen:t})},a.toggleFloorOverlay=function(e){var t=e.open;a.setState({isFloorOverlayOpen:t})},a.toggleErrorOverlay=function(e){var t=e.open,o=e.message,n=void 0===o?"Unknown":o;t?a.setState(function(e){return{errors:[].concat(k()(e.errors),[n]),isErrorOverlayOpen:!0}}):a.setState({isErrorOverlayOpen:!1,errors:[]})},a.toggleLoadingSpinner=function(e){var t=e.show,o=e.source,n=void 0===o?"unknown":o,i=a.state.showLoadingSpinner;a.setState(function(e){return{loadingSources:r()({},e.loadingSources,v()({},n,t))}},function(){if(t&&!i)a.setState({showLoadingSpinner:t});else if(!t){var e=a.state.loadingSources;g()(e).some(function(t){return!0===e[t]})||a.setState({showLoadingSpinner:!1})}})},a.toggleMapMarkerOverlay=function(e){var t=e.open,o=e.selectedItem,n=void 0===o?null:o;a.setState({isMapMarkerOverlayOpen:t,selectedItem:n})},a.selectFloorByID=function(e){a.updateMap({floorID:e})},a.zoomToPoint=function(e,t,o){var n=a.getMapRefSize(),r=n.width,i=n.height,l=z.zoomIdentity.translate(-o*e+r/2,-o*t+i/2).scale(o);a.mapSelection.transition().duration(Qt).call(a.zoomD3.transform,l)},a.zoomBy=function(e){a.mapSelection.transition().duration(Qt).call(a.zoomD3.scaleBy,e)},a.zoomIn=function(){a.zoomBy(1+Jt)},a.zoomOut=function(){a.zoomBy(1-Jt)},a.onClick=function(e){var t=a.mapRef.isEqualNode(e.target)||a.mapImage.isEqualNode(e.target);a.props.onMapClick&&t?(console.warn("onMapClick() is experimental, please do not use it"),setTimeout(function(){a.props.onMapClick(e)},0)):t&&a.toggleMapMarkerOverlay({open:!1})},a.onMarkerClick=(n=s()(i.a.mark(function e(t){var n,r,l,c,u,d,p,h;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!0,r=a.props,l=r.onTagClick,c=r.onPlacemarkClick,u=r.onMarkerClick,d=t.event_type?l:c,p=function(){var e=s()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=9;break}return e.prev=1,e.next=4,d(t,{preventDefault:h});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:if(!u){e.next=19;break}return console.warn("onMarkerClick() is experimental, please do not use it"),e.prev=11,e.next=14,u(t,{preventDefault:h});case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(11),console.error(e.t1);case 19:case"end":return e.stop()}},e,o,[[1,6],[11,16]])}));return function(){return e.apply(this,arguments)}}(),h=function(){n=!1},e.next=7,p();case 7:n&&a.toggleMapMarkerOverlay({open:!0,selectedItem:t});case 8:case"end":return e.stop()}},e,o)})),function(e){return n.apply(this,arguments)}),a.state={isFloorOverlayOpen:!1,isTagListOverlayOpen:!1,isMapMarkerOverlayOpen:!1,isErrorOverlayOpen:!1,isPanningOrZooming:!1,showLoadingSpinner:!1,loadingSources:{},errors:[],mapTransform:"",mapZoomFactor:.5,floors:[],placemarksData:null,svgURL:null,tagsConnection:null,tagsStatus:"Connecting",selectedItem:null,areTagsLoading:!0,allTagData:[]},a.tagsTimeout=null,a.mapSelection=null,a.mapRef=null,a.validateFloorID(),a}return R()(t,e),I()(t,[{key:"componentDidMount",value:function(){var e,t=this.props,o=t.api,n=t.locationID;"staging"===(e=o.environment)||"production"===e||"eu"===e||"development"===e?n?(this.initializeFloors(),this.initializeTags()):this.toggleErrorOverlay({open:!0,message:'createMap error: "options.locationID" is required'}):this.toggleErrorOverlay({open:!0,message:'API error: "'+o.environment+'" is not a valid environment'})}},{key:"componentDidUpdate",value:function(e){e.floorID!==this.props.floorID&&(this.zoomToDefault(),this.validateFloorID())}},{key:"componentWillUnmount",value:function(){this.tagsTimeout&&clearTimeout(this.tagsTimeout)}},{key:"validateFloorID",value:function(){this.props.floorID||this.toggleErrorOverlay({open:!0,message:'createMap error: "options.floorID" is required'})}},{key:"initializeTags",value:function(){var e,t=this,o=(e=s()(i.a.mark(function e(){var n,r,a,l,s,c,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,r=n.api,a=n.locationID,l=n.showControlTags,s=Kt,e.next=4,he({api:r,locationID:a,floorID:s});case 4:c=e.sent,u=c.filter(function(e){return!0===l||!e.editor_data.is_control_tag}),t.setState({areTagsLoading:!1,allTagData:u}),t.tagsTimeout=setTimeout(o,3e5);case 8:case"end":return e.stop()}},e,t)})),function(){return e.apply(this,arguments)});o()}},{key:"getFloors",value:function(){var e=s()(i.a.mark(function e(){var t,o,n,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,o=t.locationID,n=t.api,r="locations/"+o+"/maps",a=void 0,e.prev=3,e.next=6,pe(n,r);case 6:a=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),e.t0.response&&e.t0.response.data&&e.t0.response.data.detail&&this.toggleErrorOverlay({open:!0,message:e.t0.response.data.detail});case 12:return a&&a.length||this.toggleErrorOverlay({open:!0,message:"Floor data could not be found."}),e.abrupt("return",a);case 14:case"end":return e.stop()}},e,this,[[3,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"getMapData",value:function(){var e=this.props.floorID,t=this.state.floors,o=!0,n=!1,r=void 0;try{for(var a,i=h()(t);!(o=(a=i.next()).done);o=!0){var l=a.value;if(l.id===e)return l}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}return null}},{key:"initializeFloors",value:function(){var e=s()(i.a.mark(function e(){var t,o,n=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.toggleLoadingSpinner({show:!0,source:"map"}),t=this.props.onFloorsUpdate,e.next=4,this.getFloors();case 4:(o=e.sent)&&o.length>0&&this.setState({floors:o},function(){n.zoomD3||n.addZoomBehavior(),n.zoomToDefault(),le(t,o)}),this.toggleLoadingSpinner({show:!1,source:"map"});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addZoomBehavior",value:function(){var e=this;if(this.mapRef){this.zoomD3=z.zoom().filter(function(){return e.props.shouldMapPanZoom(F.event)}).scaleExtent([1/16,14]).duration(Qt).on("zoom",function(){var t=z.zoomTransform(e.mapRef),o=t.k,n="translate("+t.x+"px, "+t.y+"px) scale("+o+")";e.setState({mapTransform:n,mapZoomFactor:o,isPanningOrZooming:!0})}).on("end.zoom",function(){e.setState({isPanningOrZooming:!1})}),this.mapSelection=F.select(this.mapRef),this.mapSelection.call(this.zoomD3)}}},{key:"zoomToDefault",value:function(){var e=this.getMapData(),t=this.getMapRefSize();e&&(this.mapSelection.call(this.zoomD3.translateTo,e.width/2,e.height/2),this.mapSelection.call(this.zoomD3.scaleTo,.5*t.width/e.width))}},{key:"getMapRefSize",value:function(){return{width:this.mapRef.clientWidth,height:this.mapRef.clientHeight}}},{key:"shouldShowFloors",value:function(){var e=this.props.showFloorsControl,t=this.state.floors;return e&&t.length>1}},{key:"renderFloorLabel",value:function(){var e=this.getMapData();return e?Object(c.h)(me,{buildingName:e.group_name,floorName:e.name}):null}},{key:"renderFloorOverlay",value:function(){var e=this.props.floorID,t=this.state,o=t.isFloorOverlayOpen,n=t.floors;return o?Object(c.h)(Pe,{currentFloorID:e,floors:n,toggleFloorOverlay:this.toggleFloorOverlay,selectFloorByID:this.selectFloorByID}):null}},{key:"renderTagListOverlay",value:function(){var e=this.props,t=e.locationID,o=e.floorID,n=e.api,r=e.tags,a=this.state,i=a.isTagListOverlayOpen,l=a.floors,s=a.allTagData,u=a.areTagsLoading;return i?Object(c.h)(at,{onMarkerClick:this.onMarkerClick,showControlTags:r.showControlTags,floors:l,loading:u,tags:s,tagOptions:r,updateMap:this.updateMap,api:n,locationID:t,currentFloorID:o,toggleTagListOverlay:this.toggleTagListOverlay}):null}},{key:"renderMapMarkerOverlay",value:function(){var e=this.state,t=e.isMapMarkerOverlayOpen,o=e.selectedItem;return t&&o?Object(c.h)(dt,{toggleMapMarkerOverlay:this.toggleMapMarkerOverlay,kind:"placemark"===o.kind?"placemark":"tag",item:o}):null}},{key:"renderLoadingSpinner",value:function(){return this.state.showLoadingSpinner?Object(c.h)(ht,null):null}},{key:"renderErrorOverlay",value:function(){return this.state.isErrorOverlayOpen?Object(c.h)(bt,{toggleErrorOverlay:this.toggleErrorOverlay,messages:this.state.errors}):null}},{key:"render",value:function(){var e=this,t=this.getMapData(),o=this.state,n=o.selectedItem,r=o.mapTransform,a=o.mapZoomFactor,i=o.isPanningOrZooming,l=o.errors,s=this.props,u=s.showTagsControl,d=s.locationID,p=s.floorID,h=s.api,f=s.tags,g=s.placemarks,m=s.width,v=s.height,b=s.onTagsUpdate;return Object(c.h)("div",{className:U("meridian-map-container",$t,Xt&&to),style:{width:m,height:v}},Object(c.h)(V,null),Object(c.h)($,{onZoomIn:this.zoomIn,onZoomOut:this.zoomOut}),this.renderLoadingSpinner(),this.renderErrorOverlay(),this.renderMapMarkerOverlay(),this.renderFloorOverlay(),this.renderTagListOverlay(),Object(c.h)(Et,{showFloors:this.shouldShowFloors(),showTagList:u,toggleFloorOverlay:this.toggleFloorOverlay,toggleTagListOverlay:this.toggleTagListOverlay,toggleLoadingSpinner:this.toggleLoadingSpinner,toggleErrorOverlay:this.toggleErrorOverlay}),this.renderFloorLabel(),Object(c.h)("div",{ref:function(t){e.mapRef=t},className:U("meridian-map-background",eo),onClick:this.onClick,style:{width:m,height:v}},Object(c.h)("div",{style:{transform:r,transformOrigin:"0 0 0"}},Object(c.h)("img",{src:t&&t.svg_url,ref:function(t){e.mapImage=t}}),!l.length&&t?Object(c.h)(Nt,{selectedItem:n,isPanningOrZooming:i,mapZoomFactor:a,locationID:d,floorID:p,api:h,markers:g,onMarkerClick:this.onMarkerClick,toggleLoadingSpinner:this.toggleLoadingSpinner}):null,!l.length&&t?Object(c.h)(Lt,{selectedItem:n,isPanningOrZooming:i,mapZoomFactor:a,locationID:d,floorID:p,api:h,markers:f,onMarkerClick:this.onMarkerClick,onUpdate:b,toggleLoadingSpinner:this.toggleLoadingSpinner}):null)))}}]),t}(c.Component);oo.propTypes={shouldMapPanZoom:M.a.func,update:M.a.func.isRequired,width:M.a.string,height:M.a.string,locationID:M.a.string.isRequired,floorID:M.a.string.isRequired,api:M.a.object,showFloorsControl:M.a.bool,showTagsControl:M.a.bool,tags:M.a.shape({showControlTags:M.a.bool,filter:M.a.func,disabled:M.a.bool}),placemarks:M.a.shape({showHiddenPlacemarks:M.a.bool,filter:M.a.func,disabled:M.a.bool}),onMarkerClick:M.a.func,onTagClick:M.a.func,onPlacemarkClick:M.a.func,onMapClick:M.a.func,onTagsUpdate:M.a.func,onFloorsUpdate:M.a.func,onMapUpdate:M.a.func},oo.defaultProps={showTagsControl:!0,showFloorsControl:!0,shouldMapPanZoom:function(){return!0},width:"100%",height:"400px",placemarks:{},tags:{},onTagsUpdate:function(){},onFloorsUpdate:function(){},onMapUpdate:function(){}};var no=oo;o.d(t,"version",function(){return uo}),o.d(t,"restrictedPanZoom",function(){return po}),o.d(t,"init",function(){return ho}),o.d(t,"createMap",function(){return fo}),o.d(t,"createAPI",function(){return go});var ro=function(){var e=s()(i.a.mark(function e(t){var o,n=t.action,r=t.locationID,a=t.onTagsUpdate,l=void 0!==a&&a,s=t.tagsFilter,c=void 0!==s&&s,u=t.placemarksFilter,p=void 0!==u&&u,h=t.internalUpdate;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o={v:"1",tid:"UA-56747301-5",an:"MeridianSDK",ds:"app",av:"0.5.0",uid:r,cid:r,t:"event",ec:"code",ea:n,ev:1,el:h?"internal":"external",cm1:l?1:0,cm2:c?1:0,cm3:p?1:0,ul:navigator.language,sr:co,aip:1,ua:window.navigator.userAgent,z:Math.random().toString(36).substring(7)},d.a.get("https://www.google-analytics.com/collect",{params:o});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),ao=function(){return o(25)};"complete"===document.readyState?setTimeout(ao,0):document.addEventListener("DOMContentLoaded",ao,!1);var io={api:null},lo=window.devicePixelRatio||1,so=window.screen,co=so.width*lo+"x"+so.height*lo,uo="0.5.0";function po(e){var t=e.type,o=e.touches,n=e.shiftKey;return!("wheel"===t&&!n)&&("touchstart"!==t||o.length>=2)}function ho(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie("init","options")).api,t=void 0===e?ie("init","options.api"):e;io.api=t}function fo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie("createMap","node"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ie("createMap","options"),o=null,n=function(e){o=e},a=function o(a){var l=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).internalUpdate,s=void 0===l||l;t=r()({},t,a),i=Object(c.render)(Object(c.h)(no,r()({api:io.api,update:o},t,{ref:n})),e,i),ro({action:"map.update",locationID:t.locationID,onTagsUpdate:Boolean(t.onTagsUpdate),tagsFilter:Boolean(t.tags&&t.tags.filter),placemarksFilter:Boolean(t.placemarks&&t.placemarks.filter),internalUpdate:s})},i=Object(c.render)(Object(c.h)(no,r()({api:io.api,update:a},t,{ref:n})),e);return ro({action:"createMap",locationID:t.locationID,onTagsUpdate:Boolean(t.onTagsUpdate),tagsFilter:Boolean(t.tags&&t.tags.filter),placemarksFilter:Boolean(t.placemarks&&t.placemarks.filter)}),{update:function(e){a(e,{internalUpdate:!1})},zoomToDefault:function(){o.zoomToDefault()},zoomToPoint:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie("map.zoomToPoint","options"),t=e.x,n=void 0===t?ie("map.zoomToPoint.options","x"):t,r=e.y,a=void 0===r?ie("map.zoomToPoint.options","y"):r,i=e.scale,l=void 0===i?ie("map.zoomToPoint.options","scale"):i;o.zoomToPoint(n,a,l)}}}function go(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie("createAPI","options");return new Yt(e)}},function(e,t){e.exports=require("preact/debug")},function(e,t,o){
/*!
 * @license
 * Copyright 2018 Hewlett Packard Enterprise Development LP
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
e.exports=o(24)}]));